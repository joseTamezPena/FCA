---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: console
---


```{r}
library(igraph)
namecode <- read.csv("~/GitHub/FCA/Data/Parkinson_names.csv")


cmax <- apply(bmd$bagging$formulaNetwork,2,max)
cnames <- names(cmax[cmax>=0.5])
cmax <- cmax[cmax>=0.5]
adma <- bmd$bagging$formulaNetwork[cnames,cnames]

for (cx in c(1:nrow(namecode)))
{
  cnames <- str_replace_all(cnames,namecode[cx,1],namecode[cx,2])
}
cnames <- str_replace_all(cnames,"_","")
cnames <- str_replace_all(cnames,"th","")
rownames(adma) <- cnames
colnames(adma) <- cnames
names(cmax) <- cnames
#diag(adma) <- 0;
adma[adma<0.25] <- 0;
gr <- graph_from_adjacency_matrix(adma,mode = "undirected",diag = FALSE,weighted=TRUE)
#gr$layout <- layout_in_circle
#gr$layout <- layout_nicely
#gr$layout <- layout_as_tree
#gr$layout <- layout_with_sugiyama
#gr$layout <- layout_with_lgl
#gr$layout <- layout_with_graphopt
#gr$layout <- layout_on_sphere
#gr$layout <- layout_as_star
#gr$layout <- layout_with_dh

#gr$layout <- layout_with_kk
#gr$layout <- layout_with_gem
gr$layout <- layout_with_fr

fc <- cluster_optimal(gr)
plot(fc, gr,
     vertex.size=20*cmax,
     vertex.label.cex=0.75,
     vertex.label.dist=2,
     main="Decorrelated Feature Association")

```

